# 请求基本流程（PHP开发视角）

用户在浏览器输入网址后发生了什么


当用户在浏览器输入网址并按下回车后，从PHP开发者的角度来看，会发生以下一系列事件：

## 1. DNS解析阶段
- 浏览器检查本地DNS缓存，查找域名对应的IP地址
- 如果没有缓存，向配置的DNS服务器发起查询请求
- 最终获取到目标服务器的IP地址

## 2. 建立TCP连接
- 浏览器与服务器通过TCP三次握手建立连接
- 如果是HTTPS，还会进行SSL/TLS握手过程

## 3. 发送HTTP请求
- 浏览器发送HTTP请求到服务器，例如：
  ```
  GET /index.php HTTP/1.1
  Host: example.com
  ```

## 4. Web服务器处理（以Apache/Nginx为例）
- Web服务器接收请求并检查请求的文件类型
- 对于.php文件，Web服务器会将请求转发给PHP解释器（通过`PHP-FPM`或`mod_php`）

## 5. PHP处理阶段
- PHP解释器执行以下操作：
  - 解析`php.ini`配置文件
  - 加载请求的PHP文件
  - 解析PHP代码，执行编译为`opcode`
  - 执行`opcode`，生成动态内容
  - 处理可能涉及的数据库查询、文件操作等
  - 处理会话（`session_start()`等）

## 6. 生成响应
- PHP脚本执行完毕后，输出内容（通常是HTML）
- Web服务器接收PHP的输出，构建完整的HTTP响应

## 7. 返回响应给浏览器
- Web服务器将响应通过TCP连接发送回浏览器
- 响应包含状态码、头部和主体内容

## 8. 浏览器渲染
- 浏览器接收响应，解析HTML
- 处理CSS和JavaScript
- 渲染页面内容

## 9. 后续交互
- 可能触发AJAX请求获取更多数据
- 处理用户交互事件

## PHP开发者需要关注的重点
1. **请求生命周期**：理解从请求到响应的完整流程
2. **超全局变量**：`$_GET`, `$_POST`, `$_SERVER`等的使用
3. **会话管理**：`session_start()`, `$_SESSION`的使用
4. **数据库交互**：`PDO/mysqli`连接和查询
5. **输出缓冲**：`ob_start()`等函数的使用
6. **错误处理**：`error_reporting`, `try/catch`等
7. **性能优化**：`opcache`, 查询优化等

理解这个过程有助于PHP开发者更好地调试和优化应用程序。