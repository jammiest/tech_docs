# NoSQL 简介

NoSQL（Not Only SQL）是一类非关系型数据库，用于解决传统关系型数据库（如 MySQL）在高并发、海量数据、灵活 schema 场景下的局限性。主要特点：

- **灵活的数据模型**：支持键值、文档、列族、图等结构，无固定 schema。
- **高扩展性**：分布式架构，易于水平扩展（如分片、副本）。
- **高性能**：优化特定读写场景（如内存操作、批量写入）。
- **弱一致性**：部分支持最终一致性（CAP 理论权衡）。

## NoSQL 分类及对比表格

| 类型         | 代表数据库       | 数据模型         | 优点                      | 缺点                         | 典型场景                     |
| ------------ | ---------------- | ---------------- | ------------------------- | ---------------------------- | ---------------------------- |
| **键值存储** | Redis, DynamoDB  | Key-Value        | 超高读写性能，低延迟      | 功能简单，无复杂查询         | 缓存、会话存储、计数器       |
| **文档型**   | MongoDB, CouchDB | JSON/BSON 文档   | 灵活 schema，支持二级索引 | 事务支持较弱（MongoDB 4.0+） | 内容管理、用户配置、日志     |
| **列族存储** | Cassandra, HBase | 列族（Columnar） | 海量数据存储，高写入吞吐  | 复杂查询性能低               | 时序数据、IoT、大数据分析    |
| **图数据库** | Neo4j, ArangoDB  | 节点+边          | 高效处理关系              | 扩展性较差                   | 社交网络、推荐系统、欺诈检测 |


## 详细对比说明

### 1. 键值存储（Key-Value）

优点：
- 简单高效，适合高性能读写（如 Redis 内存操作）。
- 天然支持分布式（如 DynamoDB 自动分片）。

缺点：
- 无法支持复杂查询（如范围查询、聚合）。

场景举例：
- Redis：缓存、排行榜、秒杀库存。
- DynamoDB：游戏玩家状态、电商购物车。

### 2. 文档型（Document）

优点：
- 文档内嵌套结构，贴近业务对象（如 JSON）。
- 支持索引和简单查询（如 MongoDB 的聚合管道）。

缺点：
- 跨文档事务需额外处理（MongoDB 多文档事务性能较低）。

场景举例：
- MongoDB：CMS 内容管理、用户画像（动态字段）。
- CouchDB：移动端离线数据同步。

### 3. 列族存储（Columnar）

优点：
- 高压缩比，适合稀疏数据。
- 横向扩展能力强（如 Cassandra 多数据中心支持）。

缺点：
- 仅适合特定查询模式（如按行键检索）。

场景举例：
- Cassandra：日志存储、传感器数据（时间序列）。
- HBase：大数据分析（如 HBase + Hadoop）。

### 4. 图数据库（Graph）

优点：
- 高效遍历关系（如好友推荐、路径分析）。
- 直观建模（节点和边表示实体与关系）。

缺点：
- 集群扩展难度大（Neo4j 主从架构）。

场景举例：
- Neo4j：社交网络、知识图谱、金融反欺诈。


## 选型建议

- 需要缓存或高速读写 → Redis（键值）。
- 处理动态结构业务数据 → MongoDB（文档型）。
- 海量写入+分析 → Cassandra/HBase（列族）。
- 复杂关系查询 → Neo4j（图数据库）。

## 对比关系型数据库（SQL vs NoSQL）

| 特性           | SQL (MySQL, PostgreSQL)   | NoSQL (MongoDB, Redis)        |
| -------------- | ------------------------- | ----------------------------- |
| **数据模型**   | 固定表结构（行列）        | 灵活结构（JSON/键值/图/列族） |
| **Schema**     | 需预定义字段类型和约束    | 无固定 schema，动态扩展       |
| **扩展性**     | 垂直扩展（升级硬件）      | 水平扩展（分布式集群）        |
| **事务支持**   | ACID 强一致性（跨表事务） | 最终一致性（部分支持 ACID）   |
| **查询能力**   | 复杂 JOIN、子查询、聚合   | 简单查询或特定模式优化        |
| **性能优化**   | 适合复杂分析型查询        | 适合高并发读写和特定场景优化  |
| **适用场景**   | 金融系统、ERP、报表系统   | 互联网、IoT、实时分析、缓存   |
| **代表数据库** | MySQL, PostgreSQL, Oracle | MongoDB, Redis, Cassandra     |

## 关键差异说明

1. 数据模型
- SQL：严格遵循表结构，修改 schema 需迁移数据（如 ALTER TABLE）。
- NoSQL：文档型（MongoDB）可直接插入任意字段，键值型（Redis）无结构限制。
2. 扩展性
- SQL：通常通过升级服务器配置（CPU/内存）提升性能。
- NoSQL：通过分片（Sharding）和副本（Replica）实现分布式扩展。
3. 事务与一致性
- SQL：跨行/表事务保证数据强一致性（如银行转账）。
- NoSQL：多数为最终一致性（如 Cassandra），仅部分支持多文档事务（如 MongoDB 4.0+）。
4. 查询能力
- SQL：支持多表关联查询（JOIN）和复杂聚合（GROUP BY）。
- NoSQL：需按数据模型设计查询方式（如 MongoDB 聚合管道、Redis 键值直接访问）。



## 选型建议

**选 SQL**：

- 需要严格的事务（如支付系统）。
- 数据结构稳定，需复杂查询（如财务报表）。

**选 NoSQL**：

- 高并发读写（如电商秒杀）。
- 动态 schema（如用户个性化配置）。
- 海量数据+水平扩展（如日志存储）。